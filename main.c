#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#include <time.h>
#include "queue.h"
#include "sorting.h"
#include "file.h"
#include "benchmark.h"

int* input_array_dynamic(int* size) {
    printf("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ° Ñ‡ĞµÑ€ĞµĞ· Ğ¿Ñ€Ğ¾Ğ±ĞµĞ» (Ğ´Ğ»Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Enter):\n");
    printf("> ");
    
    char line[1024];
    if (fgets(line, sizeof(line), stdin) == NULL) {
        return NULL;
    }
    
    // Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ» Ğ½Ğ¾Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¸
    line[strcspn(line, "\n")] = 0;
    
    if (strlen(line) == 0) {
        printf("ĞĞµ Ğ²Ğ²ĞµĞ´ĞµĞ½Ğ¾ Ğ½Ğ¸ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ñ‡Ğ¸ÑĞ»Ğ°!\n");
        return NULL;
    }
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ±ÑƒĞºĞ² Ğ¸Ğ»Ğ¸ Ğ½ĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ñ… ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²
    for (int i = 0; line[i] != '\0'; i++) {
        // Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ°ĞµĞ¼: Ñ†Ğ¸Ñ„Ñ€Ñ‹, Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹, Ñ‚Ğ°Ğ±ÑƒĞ»ÑÑ†Ğ¸Ğ¸, Ğ·Ğ½Ğ°ĞºĞ¸ + Ğ¸ - (Ğ´Ğ»Ñ Ğ¾Ñ‚Ñ€Ğ¸Ñ†Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ñ‡Ğ¸ÑĞµĞ»)
        if (!isdigit(line[i]) && 
            line[i] != ' ' && 
            line[i] != '\t' && 
            line[i] != '+' && 
            line[i] != '-' &&
            line[i] != '\0') {
            
            // Ğ•ÑĞ»Ğ¸ ÑÑ‚Ğ¾ Ğ·Ğ½Ğ°Ğº + Ğ¸Ğ»Ğ¸ -, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»
            if ((line[i] == '+' || line[i] == '-') && 
                i + 1 < strlen(line) && 
                isdigit(line[i + 1])) {
                // Ğ­Ñ‚Ğ¾ Ğ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ğ¾: Ğ·Ğ½Ğ°Ğº Ğ¿ĞµÑ€ĞµĞ´ Ñ‡Ğ¸ÑĞ»Ğ¾Ğ¼
                continue;
            }
            
            printf("ĞÑˆĞ¸Ğ±ĞºĞ°: Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½ Ğ½ĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ» '%c' Ğ² Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ %d\n", line[i], i + 1);
            printf("Ğ’Ğ²Ğ¾Ğ´Ğ¸Ñ‚Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ†ĞµĞ»Ñ‹Ğµ Ñ‡Ğ¸ÑĞ»Ğ° Ğ¸ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹!\n");
            return NULL;
        }
    }
    
    // ĞŸĞ¾Ğ´ÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ñ‡Ğ¸ÑĞµĞ»
    int count = 0;
    char* ptr = line;
    while (*ptr) {
        // ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹
        while (*ptr && isspace(*ptr)) ptr++;
        
        // Ğ•ÑĞ»Ğ¸ Ğ½Ğ°ÑˆĞ»Ğ¸ Ñ‡Ğ¸ÑĞ»Ğ¾
        if (*ptr && !isspace(*ptr)) {
            // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ñ‡Ñ‚Ğ¾ ÑÑ‚Ğ¾ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾ Ñ‡Ğ¸ÑĞ»Ğ°
            if (*ptr == '+' || *ptr == '-' || isdigit(*ptr)) {
                count++;
            }
            // ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ñ‡Ğ¸ÑĞ»Ğ¾
            while (*ptr && !isspace(*ptr)) ptr++;
        }
    }
    
    if (count == 0) {
        printf("ĞĞµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ Ñ‡Ğ¸ÑĞµĞ» Ğ²Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğµ!\n");
        return NULL;
    }
    
    // Ğ’Ñ‹Ğ´ĞµĞ»ÑĞµĞ¼ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ Ğ¿Ğ¾Ğ´ Ğ¼Ğ°ÑÑĞ¸Ğ²
    int* arr = (int*)malloc(count * sizeof(int));
    if (arr == NULL) {
        printf("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ²Ñ‹Ğ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸!\n");
        return NULL;
    }
    
    // Ğ¡Ñ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ‡Ğ¸ÑĞ»Ğ° Ñ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¾Ğ¹
    ptr = line;
    int index = 0;
    
    while (*ptr && index < count) {
        // ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹
        while (*ptr && isspace(*ptr)) ptr++;
        
        if (*ptr) {
            // Ğ¡Ñ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¾Ğ´Ğ½Ğ¾ Ñ‡Ğ¸ÑĞ»Ğ¾
            int value;
            int chars_read;
            
            // ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ‡Ğ¸ÑĞ»Ğ¾
            if (sscanf(ptr, "%d%n", &value, &chars_read) == 1) {
                // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, Ñ‡Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ğ»Ğ¸ Ğ²ÑĞµ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹ Ñ‡Ğ¸ÑĞ»Ğ°
                char temp[20];
                sprintf(temp, "%d", value);
                int expected_chars = strlen(temp);
                
                // Ğ£Ñ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğ¹ Ğ·Ğ½Ğ°Ğº
                if (ptr[0] == '+' || ptr[0] == '-') {
                    expected_chars++;
                }
                
                // Ğ•ÑĞ»Ğ¸ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ğ»Ğ¸ Ğ¼ĞµĞ½ÑŒÑˆĞµ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ², Ñ‡ĞµĞ¼ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ»Ğ¾ÑÑŒ, Ğ·Ğ½Ğ°Ñ‡Ğ¸Ñ‚ Ğ±Ñ‹Ğ»Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ°
                if (chars_read < expected_chars) {
                    printf("ĞÑˆĞ¸Ğ±ĞºĞ°: Ğ² Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ %ld Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½ Ğ½ĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ ÑĞ¸Ğ¼Ğ²Ğ¾Ğ» Ğ² Ñ‡Ğ¸ÑĞ»Ğµ\n", 
                           (ptr - line) + chars_read + 1);
                    free(arr);
                    return NULL;
                }
                
                arr[index] = value;
                index++;
                ptr += chars_read;
            } else {
                // Ğ•ÑĞ»Ğ¸ Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ‡Ğ¸ÑĞ»Ğ¾
                printf("ĞÑˆĞ¸Ğ±ĞºĞ°: Ğ½ĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ² Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ %ld\n", ptr - line + 1);
                free(arr);
                return NULL;
            }
        }
    }
    
    *size = count;
    printf("âœ… Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾ ÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ¾ %d Ñ‡Ğ¸ÑĞµĞ»\n", count);
    return arr;
}

void print_array(int arr[], int size) {
    if (size <= 20) {
        // ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ²Ğ¾Ğ´ Ğ´Ğ»Ñ Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¸Ñ… Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ¾Ğ²
        printf("[");
        for (int i = 0; i < size; i++) {
            printf("%d", arr[i]);
            if (i < size - 1) printf(", ");
        }
        printf("]\n");
    } else {
        // Ğ¡Ğ¾ĞºÑ€Ğ°Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ²Ğ¾Ğ´ Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ¾Ğ²
        printf("[");
        for (int i = 0; i < 5; i++) {
            printf("%d, ", arr[i]);
        }
        printf("..., ");
        for (int i = size - 5; i < size; i++) {
            printf("%d", arr[i]);
            if (i < size - 1) printf(", ");
        }
        printf("]\n");
    }
}

void print_time(double time_ms, const char* sort_name) {
    if (time_ms < 1.0) {
        printf("%s: %.3f Ğ¼Ñ (%.0f Ğ¼ĞºÑ)\n", sort_name, time_ms, time_ms * 1000);
    } else if (time_ms < 1000.0) {
        printf("%s: %.3f Ğ¼Ñ\n", sort_name, time_ms);
    } else {
        printf("%s: %.3f Ğ¼Ñ (%.3f Ñ)\n", sort_name, time_ms, time_ms / 1000.0);
    }
}

void show_menu() {
    printf("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("                ĞœĞ•ĞĞ® ĞŸĞ ĞĞ“Ğ ĞĞœĞœĞ« Ğ¡ĞĞ Ğ¢Ğ˜Ğ ĞĞ’ĞšĞ˜                \n");
    printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("1. Ğ’Ğ²ĞµÑÑ‚Ğ¸ Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ Ğ¸ Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ\n");
    printf("2. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…\n");
    printf("3. Ğ’Ñ‹Ğ¹Ñ‚Ğ¸ Ğ¸Ğ· Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹\n");
    printf("\nĞ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ (1-3): ");
}

// Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Python-ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ° Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
void show_graph() {
    printf("\nğŸ“Š Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ°...\n");
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ° results.txt
    FILE* results_file = fopen("results.txt", "r");
    if (results_file == NULL) {
        printf("âš ï¸  Ğ¤Ğ°Ğ¹Ğ» results.txt Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½.\n");
        printf("   Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ° Ñ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°Ğ¼Ğ¸.\n");
        return;
    }
    fclose(results_file);
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ° graph.py
    FILE* graph_script = fopen("graph.py", "r");
    if (graph_script == NULL) {
        printf("âš ï¸  Ğ¤Ğ°Ğ¹Ğ» graph.py Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½ Ğ² Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸.\n");
        printf("   Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ graph.py Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ² Ñ‚Ğ¾Ğ¹ Ğ¶Ğµ Ğ¿Ğ°Ğ¿ĞºĞµ, Ñ‡Ñ‚Ğ¾ Ğ¸ ÑÑ‚Ğ° Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°.\n");
        return;
    }
    fclose(graph_script);
    
    printf("âœ… Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°Ñ Python-ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ´Ğ»Ñ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ°...\n");
    printf("   (ĞÑ‚ĞºÑ€Ğ¾ĞµÑ‚ÑÑ Ğ½Ğ¾Ğ²Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¾Ğ¼)\n\n");
    
    // Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Python-ÑĞºÑ€Ğ¸Ğ¿Ñ‚
    int result = system("python3 graph.py");
    
    if (result == 0) {
        printf("\nâœ… Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½ Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½ ĞºĞ°Ğº graph.png\n");
        printf("   Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ñ‚Ğ°ĞºĞ¶Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹ Ğ² Ñ„Ğ°Ğ¹Ğ»Ğµ results.txt\n");
    } else {
        printf("\nâš ï¸  ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº.\n");
        printf("   Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ, Ñ‡Ñ‚Ğ¾ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Python Ğ¸ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° matplotlib.\n");
        printf("   Ğ”Ğ»Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ matplotlib Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ: pip install matplotlib\n");
    }
}

int main() {
    int choice;
    
    printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("                ĞŸĞ ĞĞ“Ğ ĞĞœĞœĞ Ğ¡ĞĞ Ğ¢Ğ˜Ğ ĞĞ’ĞšĞ˜ ĞœĞĞ¡Ğ¡Ğ˜Ğ’ĞĞ’             \n");
    printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    
    while (1) {
        show_menu();
        
        if (scanf("%d", &choice) != 1) {
            // ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ±ÑƒÑ„ĞµÑ€Ğ° Ğ²Ğ²Ğ¾Ğ´Ğ°
            while (getchar() != '\n');
            printf("ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ²Ğ²Ğ¾Ğ´. Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ¾Ñ‚ 1 Ğ´Ğ¾ 3.\n");
            continue;
        }
        
        // ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ±ÑƒÑ„ĞµÑ€Ğ° Ğ¿Ğ¾ÑĞ»Ğµ scanf
        while (getchar() != '\n');
        
        if (choice == 1) {
            // Ğ ĞµĞ¶Ğ¸Ğ¼ 1: Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ğ²Ğ²Ğ¾Ğ´
            printf("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
            printf("               Ğ Ğ•Ğ–Ğ˜Ğœ 1: Ğ Ğ£Ğ§ĞĞĞ™ Ğ’Ğ’ĞĞ” ĞœĞĞ¡Ğ¡Ğ˜Ğ’Ğ              \n");
            printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n");
            
            int size;
            int* arr = input_array_dynamic(&size);
            
            if (arr == NULL) {
                printf("ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ÑĞ½Ğ¾Ğ²Ğ°.\n");
                continue;
            }
            
            printf("\nĞ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğ¹ Ğ¼Ğ°ÑÑĞ¸Ğ²: ");
            print_array(arr, size);
            
            // Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ Ğ¸Ğ· Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ°
            Queue* p = array_to_queue(arr, size);
            printf("ĞÑ‡ĞµÑ€ĞµĞ´ÑŒ Ğ¸Ğ· Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ°: ");
            print_queue(p);
            printf("\n");
            
            // ĞšĞ¾Ğ¿Ğ¸Ğ¸ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ¾Ğ² Ğ´Ğ»Ñ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ¾Ğº
            int* arr_selection = (int*)malloc(size * sizeof(int));
            int* arr_quick = (int*)malloc(size * sizeof(int));
            
            if (arr_selection == NULL || arr_quick == NULL) {
                printf("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ²Ñ‹Ğ´ĞµĞ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸!\n");
                free(arr);
                if (arr_selection) free(arr_selection);
                if (arr_quick) free(arr_quick);
                free_queue(p);
                continue;
            }
            
            memcpy(arr_selection, arr, size * sizeof(int));
            memcpy(arr_quick, arr, size * sizeof(int));
            
            // Ğ˜Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ¼
            clock_t start = clock();
            selection_sort(arr_selection, size);
            clock_t end = clock();
            double selection_time = ((double)(end - start)) * 1000 / CLOCKS_PER_SEC;
            
            // Ğ˜Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ¹ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸
            start = clock();
            quick_sort(arr_quick, 0, size - 1);
            end = clock();
            double quick_time = ((double)(end - start)) * 1000 / CLOCKS_PER_SEC;
            
            printf("â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
            printf(" â•‘ ğŸ“Š Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ« Ğ¡ĞĞ Ğ¢Ğ˜Ğ ĞĞ’ĞšĞ˜:\n");
            printf("â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
            
            printf("\nâ±ï¸  Ğ’Ğ Ğ•ĞœĞ¯ Ğ’Ğ«ĞŸĞĞ›ĞĞ•ĞĞ˜Ğ¯:\n");
            printf("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n");
            print_time(selection_time, "Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ¼");
            print_time(quick_time, "Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°");
            
            if (selection_time > 0 && quick_time > 0) {
                double speedup = selection_time / quick_time;
                printf("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n");
                printf("ğŸ“ˆ Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ Ğ² %.2f Ñ€Ğ°Ğ·\n", speedup);
            }
            
            printf("\nğŸ“‹ ĞĞ¢Ğ¡ĞĞ Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞĞ«Ğ• ĞœĞĞ¡Ğ¡Ğ˜Ğ’Ğ«:\n");
            printf("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n");
            printf("Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ¼:   ");
            print_array(arr_selection, size);
            
            printf("Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°:   ");
            print_array(arr_quick, size);
            
            // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸
            int correct = 1;
            for (int i = 0; i < size - 1; i++) {
                if (arr_selection[i] > arr_selection[i + 1]) {
                    correct = 0;
                    break;
                }
            }
            
            printf("\nâœ… ");
            if (correct) {
                printf("ĞœĞ°ÑÑĞ¸Ğ²Ñ‹ Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ (Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ¾)");
            } else {
                printf("ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ² ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞµ!");
            }
            printf("\n");
            
            // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ñ„Ğ°Ğ¹Ğ»Ñ‹
            write_array_to_file(arr, size, "orig.txt");
            write_array_to_file(arr_selection, size, "sorted_selection.txt");
            write_array_to_file(arr_quick, size, "sorted_quick.txt");
            
            printf("\nğŸ’¾ Ğ¤ĞĞ™Ğ›Ğ« Ğ¡ĞĞ¥Ğ ĞĞĞ•ĞĞ«:\n");
            printf("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n");
            printf("  â€¢ Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğ¹ Ğ¼Ğ°ÑÑĞ¸Ğ²:           orig.txt\n");
            printf("  â€¢ Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ¼:        sorted_selection.txt\n");
            printf("  â€¢ Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°:        sorted_quick.txt\n");
            
            // ĞÑĞ²Ğ¾Ğ±Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
            free(arr);
            free(arr_selection);
            free(arr_quick);
            free_queue(p);
            
            printf("\nĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Enter Ğ´Ğ»Ñ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ° Ğ² Ğ¼ĞµĞ½Ñ...");
            getchar();
            
        } else if (choice == 2) {
            // Ğ ĞµĞ¶Ğ¸Ğ¼ 2: Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ°Ñ…
            printf("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
            printf("          Ğ Ğ•Ğ–Ğ˜Ğœ 2: Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• ĞĞ Ğ¢Ğ•Ğ¡Ğ¢ĞĞ’Ğ«Ğ¥ Ğ¤ĞĞ™Ğ›ĞĞ¥        \n");
            printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n");
            
            // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
            printf("ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²...\n");
            int test_sizes[] = {100, 500, 1000, 5000, 10000};
            int num_tests = sizeof(test_sizes) / sizeof(test_sizes[0]);
            
            int all_files_exist = 1;
            for (int i = 0; i < num_tests; i++) {
                char filename[50];
                sprintf(filename, "test_data%d.txt", test_sizes[i]);
                FILE* f = fopen(filename, "r");
                if (f == NULL) {
                    printf("âŒ Ğ¤Ğ°Ğ¹Ğ» %s Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½!\n", filename);
                    all_files_exist = 0;
                } else {
                    fclose(f);
                    printf("âœ… Ğ¤Ğ°Ğ¹Ğ» %s Ğ½Ğ°Ğ¹Ğ´ĞµĞ½\n", filename);
                }
            }
            
            if (!all_files_exist) {
                printf("\nâš ï¸  ĞĞµ Ğ²ÑĞµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹.\n");
                printf("   Ğ”Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹: test_data100.txt, test_data500.txt Ğ¸ Ñ‚.Ğ´.\n");
                printf("   Ğ›Ğ¸Ğ±Ğ¾ Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ€ĞµĞ¶Ğ¸Ğ¼ 1 Ğ´Ğ»Ñ Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ²Ğ¾Ğ´Ğ°.\n");
                
                printf("\nĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Enter Ğ´Ğ»Ñ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ° Ğ² Ğ¼ĞµĞ½Ñ...");
                getchar();
                continue;
            }
            
            printf("\nğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸...\n\n");
            
            // Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ benchmark
            benchmark_sorting();
            
            // ĞŸĞ¾ÑĞ»Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµĞ¼ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº
            printf("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
            printf("          ĞŸĞĞšĞĞ—ĞĞ¢Ğ¬ Ğ“Ğ ĞĞ¤Ğ˜Ğš Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢ĞĞ’?                   \n");
            printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
            printf("Ğ¥Ğ¾Ñ‚Ğ¸Ñ‚Ğµ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸?\n");
            printf("1. Ğ”Ğ°, Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº\n");
            printf("2. ĞĞµÑ‚, Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒÑÑ Ğ² Ğ¼ĞµĞ½Ñ\n");
            printf("\nĞ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ (1-2): ");
            
            int graph_choice;
            if (scanf("%d", &graph_choice) != 1) {
                while (getchar() != '\n');
                printf("ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ²Ğ²Ğ¾Ğ´.\n");
            } else {
                while (getchar() != '\n'); // ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ±ÑƒÑ„ĞµÑ€Ğ°
                
                if (graph_choice == 1) {
                    show_graph();
                }
            }
            
            printf("\nĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Enter Ğ´Ğ»Ñ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ° Ğ² Ğ¼ĞµĞ½Ñ...");
            getchar();
            
        } else if (choice == 3) {
            // Ğ ĞµĞ¶Ğ¸Ğ¼ 3: Ğ²Ñ‹Ñ…Ğ¾Ğ´
            printf("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
            printf("               Ğ’Ğ«Ğ¥ĞĞ” Ğ˜Ğ— ĞŸĞ ĞĞ“Ğ ĞĞœĞœĞ«                       \n");
            printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n");
            printf("Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹! Ğ”Ğ¾ ÑĞ²Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ!\n");
            break;
            
        } else {
            printf("ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ²Ñ‹Ğ±Ğ¾Ñ€. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ¾Ñ‚ 1 Ğ´Ğ¾ 3.\n");
        }
    }
    
    return 0;
}
